<div class="container-fluid tree-background">
    <div class="row full-screen-row overlay">
        <h1>Profile</h1>
        <div class="col-md-12">
            <h2>Personal Information</h2>
            <span>
            <strong>Name:</strong> {{ profile.firstName }} {{ profile.lastName }}<br>
            <strong>Email:</strong> {{ profile.email }}<br>
            <strong>Savings:</strong> {{profile.savings}}<br>
            </span>

            <form [formGroup]="profileForm" (ngSubmit)="onProfileSubmit()" *ngIf="showProfileForm" class="col-md-4">

                <div class="form-group">
                    <label for="firstName">First Name</label>
                    <input type="text" class="form-control" id="firstName" formControlName="firstName" required>
                    <div *ngIf="formErrors.firstName" class="alert alert-danger">
                        {{ formErrors.incomeCategory }}
                    </div>
                </div>
                <div class="form-group">
                    <label for="lastName">Last Name</label>
                    <input type="text" class="form-control" id="lastName" formControlName="lastName" required>
                    <div *ngIf="formErrors.lastName" class="alert alert-danger">
                        {{ formErrors.lastName }}
                    </div>
                </div>
                <div class="form-group">
                    <label for="savings">Savings</label>
                    <input type="text" class="form-control" id="savings" formControlName="savings" required>
                    <div *ngIf="formErrors.savings" class="alert alert-danger">
                        {{ formErrors.savings }}
                    </div>
                </div>

                <button type="submit" class="btn btn-success" [disabled]="!profileForm.valid">Save</button>
                <button type="button" (click)="cancelEditProfile()" class="btn btn-warning">Cancel</button>
            </form>
            <span id="addExpense" (click)="displayProfileForm()" *ngIf="!showProfileForm">    
                Edit Profile
            </span>
        </div>
        <div class="col-md-6">

            <div class="col-md-6">
                <h2>Income</h2>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Amount</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let incomeRow of profile.income; let i = index;">
                            <td>{{ incomeRow.income_name }}</td>
                            <td>{{ incomeRow.income_amount }}</td>
                            <td> <button type="button" class="btn btn-warning" (click)="showEditIncome(incomeRow)">Edit</button> <button type="button" class="btn btn-danger" (click)="confirmDeleteIncome(incomeRow, i)">X</button></td>
                        </tr>
                    </tbody>
                </table>
                <span id="addExpense" (click)="displayIncomeForm()" *ngIf="!showIncomeForm">
                    +Add Income
                </span>
                <form [formGroup]="incomeForm" *ngIf="showIncomeForm" (ngSubmit)="onIncomeSubmit()"> 
                    <div class="form-group">
                        <label for="incomeCategory">Category</label>
                        <input type="text" class="form-control" id="incomeCategory" formControlName="incomeCategory" required>
                        <div *ngIf="formErrors.incomeCategory" class="alert alert-danger">
                            {{ formErrors.incomeCategory }}
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="incomeAmount">Amount</label>
                        <input type="text" class="form-control" id="incomeAmount" formControlName="incomeAmount" required>
                        <div *ngIf="formErrors.incomeAmount" class="alert alert-danger">
                            {{ formErrors.incomeAmount }}
                        </div>
                    </div>

                    <button type="submit" class="btn btn-success" [disabled]="!incomeForm.valid">Save</button>
                    <button type="button" (click)="cancelIncome()" class="btn btn-danger">Cancel</button>
                </form>
                <h2>Expenses</h2>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Amount</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let expenseRow of profile.expenses; let i = index;">
                            <td>{{ expenseRow.expense_name }}</td>
                            <td>{{ expenseRow.expense_amount }}</td>
                            <td> <button type="button" class="btn btn-warning" (click)="showEditExpense(expenseRow)">Edit</button> <button type="button" class="btn btn-danger" (click)="confirmDeleteExpense(expenseRow, i)">X</button></td>
                        </tr>
                    </tbody>
                </table>
                <span id="addExpense" (click)="displayExpenseForm()" *ngIf="!showExpenseForm">
                    +Add Expense
                </span>
                <form [formGroup]="expenseForm" *ngIf="showExpenseForm" (ngSubmit)="onExpenseSubmit()"> 
                    <div class="form-group">
                        <label for="expenseCategory">Category</label>
                        <input type="text" class="form-control" id="expenseCategory" formControlName="expenseCategory" required>
                        <div *ngIf="formErrors.expenseCategory" class="alert alert-danger">
                            {{ formErrors.expenseCategory }}
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="expenseAmount">Amount</label>
                        <input type="text" class="form-control" id="expenseAmount" formControlName="expenseAmount" required>
                        <div *ngIf="formErrors.expenseAmount" class="alert alert-danger">
                            {{ formErrors.expenseAmount }}
                        </div>
                    </div>

                    <button type="submit" class="btn btn-success" [disabled]="!expenseForm.valid">Save</button>
                    <button type="button" (click)="cancelExpense()" class="btn btn-danger">Cancel</button>
                </form>
            </div>
        </div>
        <div class="col-md-6 overlay">
                <div style="display: block">
                    <canvas baseChart
                            [datasets]="datasets"
                            [labels]="labels"
                            [options]="options"
                            [legend]="doughnutChartLegend"
                            [colors]="chartColors"
                            [chartType]="doughnutChartType"
                            (chartHover)="chartHovered($event)"
                            (chartClick)="chartClicked($event)"></canvas>
                </div>
        </div>
    </div>
</div>
<footer></footer>
